<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Manajemen Mahasiswa</title>
<style>
/* ==========================
   Global Styles
========================== */
body {
  margin: 0;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: #f4f4f9;
  color: #333;
}

/* ==========================
   Navbar
========================== */
.navbar {
  background-color: #4b6cb7;
  background-image: linear-gradient(315deg, #4b6cb7 0%, #182848 74%);
  color: #fff;
  padding: 20px;
  text-align: center;
  font-size: 28px;
  font-weight: bold;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

/* ==========================
   Container & Grid
========================== */
.container {
  width: 95%;
  max-width: 1200px;
  margin: 30px auto;
}

.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 25px;
  margin-bottom: 25px;
}

/* ==========================
   Card
========================== */
.card {
  background-color: #fff;
  padding: 25px;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  margin-bottom: 20px;
  transition: transform 0.3s, box-shadow 0.3s;
}

.card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 20px rgba(0,0,0,0.15);
}

.card h3 {
  color: #4b6cb7;
  margin-bottom: 15px;
}

/* ==========================
   Form Elements
========================== */
input, select, button {
  width: 100%;
  padding: 12px;
  margin: 8px 0;
  border-radius: 8px;
  border: 1px solid #ccc;
  outline: none;
  background-color: #f9f9f9;
  color: #333;
  font-weight: 500;
  transition: all 0.3s;
}

input:focus, select:focus {
  border-color: #4b6cb7;
  box-shadow: 0 0 5px rgba(75,108,183,0.3);
}

button {
  background-color: #4b6cb7;
  color: #fff;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s;
  border: none;
}

button:hover {
  background-color: #3a4f7b;
  transform: translateY(-2px);
}

/* ==========================
   Tables
========================== */
.table {
  width: 100%;
  border-collapse: collapse;
  background-color: #fff;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  margin-top: 15px;
}

.table th, .table td {
  text-align: center;
  padding: 12px;
  border-bottom: 1px solid #eee;
}

.table th {
  background-color: #f0f2f5;
  color: #4b6cb7;
  font-weight: 600;
}

.table tr:hover {
  background-color: #f9f9f9;
}

.highlight {
  background-color: #d0e1ff !important;
}

/* ==========================
   Alert
========================== */
.alert {
  color: red;
  font-weight: bold;
}
</style>
</head>
<body>

<div class="navbar">Manajemen Mahasiswa</div>
<div class="container">

  <!-- Dashboard -->
  <div class="grid">
    <div class="card">
      <h3>Total Mahasiswa</h3>
      <h2 id="totalMahasiswa">0</h2>
    </div>
    <div class="card">
      <h3>Total Jurusan</h3>
      <h2 id="totalJurusan">0</h2>
    </div>
    <div class="card">
      <h3>Jurusan Terbanyak</h3>
      <h2 id="jurusanTerbanyak">-</h2>
    </div>
  </div>

  <!-- Form Tambah Mahasiswa -->
  <div class="card">
    <h3>Tambah Mahasiswa</h3>
    <input type="text" id="nim" placeholder="NIM (8-12 digit)">
    <input type="text" id="nama" placeholder="Nama">
    <input type="text" id="jurusan" placeholder="Jurusan">
    <input type="email" id="email" placeholder="Email">
    <p id="pesan" class="alert"></p>
    <button onclick="tambahMahasiswa()">Tambah Mahasiswa</button>
  </div>

  <!-- Search -->
  <div class="grid">
    <div class="card">
      <h3>Linear Search (NIM)</h3>
      <input type="text" id="searchNIM" placeholder="Masukkan NIM">
      <button onclick="linearSearch()">Cari (Linear)</button>
    </div>
    <div class="card">
      <h3>Binary Search (NIM)</h3>
      <input type="text" id="searchBinary" placeholder="Masukkan NIM">
      <button onclick="binarySearch()">Cari (Binary)</button>
    </div>
  </div>

  <!-- Sorting -->
  <div class="card">
    <h3>Sorting Mahasiswa</h3>
    <select id="sortMethod">
      <option value="insertion">Insertion Sort</option>
      <option value="merge">Merge Sort</option>
    </select>
    <button onclick="urutkan()">Urutkan</button>
  </div>

  <!-- Tabel Mahasiswa -->
  <div class="card">
    <h3>Daftar Mahasiswa</h3>
    <table class="table">
      <thead>
        <tr>
          <th>NIM</th>
          <th>Nama</th>
          <th>Jurusan</th>
          <th>Email</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  </div>

  <!-- Export / Import -->
  <div class="grid">
    <div class="card">
      <h3>Export / Import</h3>
      <button onclick="exportCSV()">Export CSV</button>
      <button onclick="exportExcel()">Export Excel</button>
      <input type="file" id="importFile" accept=".csv" onchange="importCSV(event)">
    </div>
  </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script>
// ====== Data ======
let data = JSON.parse(localStorage.getItem("mahasiswa") || "[]");
let hasil = null;

// ====== Render ======
function render() {
  const tableBody = document.getElementById("tableBody");
  tableBody.innerHTML = "";
  data.forEach(m => {
    const tr = document.createElement("tr");
    if (hasil === m.nim) tr.classList.add("highlight");
    tr.innerHTML = `
      <td>${m.nim}</td>
      <td>${m.nama}</td>
      <td>${m.jurusan}</td>
      <td>${m.email}</td>
      <td>
        <button onclick="editMahasiswa('${m.nim}')">Edit</button>
        <button onclick="hapusMahasiswa('${m.nim}')">Hapus</button>
      </td>
    `;
    tableBody.appendChild(tr);
  });
  updateDashboard();
}

// ====== Tambah ======
function tambahMahasiswa() {
  const nim = document.getElementById("nim").value.trim();
  const nama = document.getElementById("nama").value.trim();
  const jurusan = document.getElementById("jurusan").value.trim();
  const email = document.getElementById("email").value.trim();
  const pesan = document.getElementById("pesan");

  if (!nim || !nama || !jurusan || !email) {
    pesan.textContent = "Semua field harus diisi!";
    return;
  }
  if (!/^\d{8,12}$/.test(nim)) {
    pesan.textContent = "NIM harus 8â€“12 digit";
    return;
  }
  data.push({nim,nama,jurusan,email});
  localStorage.setItem("mahasiswa", JSON.stringify(data));
  pesan.textContent = "";
  document.getElementById("nim").value="";
  document.getElementById("nama").value="";
  document.getElementById("jurusan").value="";
  document.getElementById("email").value="";
  render();
}

// ====== Edit ======
function editMahasiswa(nim) {
  const mhs = data.find(m => m.nim===nim);
  const newNama = prompt("Nama:", mhs.nama);
  const newJurusan = prompt("Jurusan:", mhs.jurusan);
  const newEmail = prompt("Email:", mhs.email);
  if(newNama && newJurusan && newEmail){
    mhs.nama = newNama;
    mhs.jurusan = newJurusan;
    mhs.email = newEmail;
    localStorage.setItem("mahasiswa", JSON.stringify(data));
    render();
  }
}

// ====== Hapus ======
function hapusMahasiswa(nim){
  if(confirm("Yakin ingin menghapus?")){
    data = data.filter(m=>m.nim!==nim);
    localStorage.setItem("mahasiswa", JSON.stringify(data));
    render();
  }
}

// ====== Linear Search ======
function linearSearch(){
  const val = document.getElementById("searchNIM").value.trim();
  hasil = val;
  render();
}

// ====== Binary Search ======
function binarySearch(){
  const val = document.getElementById("searchBinary").value.trim();
  data.sort((a,b)=>a.nim.localeCompare(b.nim));
  hasil = val;
  render();
}

// ====== Sorting ======
function urutkan(){
  const method = document.getElementById("sortMethod").value;
  if(method==="insertion") insertionSort(data);
  else data = mergeSort(data);
  localStorage.setItem("mahasiswa", JSON.stringify(data));
  render();
}

function insertionSort(arr){
  for(let i=1;i<arr.length;i++){
    let key=arr[i], j=i-1;
    while(j>=0 && arr[j].nim>key.nim){
      arr[j+1]=arr[j]; j--;
    }
    arr[j+1]=key;
  }
}

function mergeSort(arr){
  if(arr.length<=1) return arr;
  const mid=Math.floor(arr.length/2);
  const left=mergeSort(arr.slice(0,mid));
  const right=mergeSort(arr.slice(mid));
  return merge(left,right);
}

function merge(left,right){
  let res=[],i=0,j=0;
  while(i<left.length && j<right.length){
    if(left[i].nim<=right[j].nim) res.push(left[i++]);
    else res.push(right[j++]);
  }
  return res.concat(left.slice(i)).concat(right.slice(j));
}

// ====== Dashboard ======
function updateDashboard(){
  document.getElementById("totalMahasiswa").textContent = data.length;
  const jurusanList = data.map(m=>m.jurusan);
  document.getElementById("totalJurusan").textContent = [...new Set(jurusanList)].length;
  if(jurusanList.length>0){
    const counts={};
    jurusanList.forEach(j=>counts[j]=(counts[j]||0)+1);
    const maxJurusan=Object.keys(counts).reduce((a,b)=>counts[a]>counts[b]?a:b);
    document.getElementById("jurusanTerbanyak").textContent = maxJurusan;
  } else document.getElementById("jurusanTerbanyak").textContent = "-";
}

// ====== Export CSV ======
function exportCSV(){
  let csv="data:text/csv;charset=utf-8,NIM,Nama,Jurusan,Email\n";
  data.forEach(m=>{ csv+=`${m.nim},${m.nama},${m.jurusan},${m.email}\n`; });
  const link=document.createElement("a");
  link.setAttribute("href",encodeURI(csv));
  link.setAttribute("download","mahasiswa.csv");
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}

// ====== Export Excel ======
function exportExcel(){
  const wb=XLSX.utils.book_new();
  const ws=XLSX.utils.json_to_sheet(data);
  XLSX.utils.book_append_sheet(wb, ws, "Mahasiswa");
  XLSX.writeFile(wb, "mahasiswa.xlsx");
}

// ====== Import CSV ======
function importCSV(event){
  const file = event.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = function(e){
    const text = e.target.result;
    const lines = text.trim().split("\n");
    for(let i=1;i<lines.length;i++){
      const [nim,nama,jurusan,email]=lines[i].split(",");
      if(nim && nama && jurusan && email){
        data.push({nim,nama,jurusan,email});
      }
    }
    localStorage.setItem("mahasiswa",JSON.stringify(data));
    render();
  };
  reader.readAsText(file);
}

// ====== Inisialisasi ======
render();
</script>

</body>
</html>
